<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
  <title>GOGO delivery - Main</title>
  <link rel="stylesheet" href="stylesheets/mainpage.css" />
</head>
<body>
  <div class="app" id ="app">
    <!-- Â∑¶‰æß‰æßËæπÊ†è -->
    <aside class="sidebar card">
      <div class="sidebar-header">
        <div class="avatar">G</div>
        <div class="hello">
          <div class="hello-title">Hello, {{username}}</div>
          <div class="hello-sub">Welcome back! üëã</div>
        </div>
      </div>

      <nav class="menu">
        <a class="menu-item" href="#">
          <span class="menu-icon">üë§</span>
          <span>Profile</span>
        </a>
        <a class="menu-item" href="#">
          <span class="menu-icon">‚öôÔ∏è</span>
          <span>Account Setting</span>
        </a>
        <div class="menu-item status-row">
          <span class="menu-icon">üõ°Ô∏è</span>
          <span>Covid Status</span>
          <span v-if="user_covid_status === 'Green'" span class="status-pill Green">Green</span>
          <span v-if="user_covid_status === 'Yellow'" span class="status-pill Yellow">Green</span>
          <span v-if="user_covid_status === 'Red'" span class="status-pill Red">Green</span>
        </div>
          <a class="menu-item" href="#" @click.prevent="signout()">
          <span class="menu-icon">‚öôÔ∏è</span>
          <span>Sign out</span>
        </a>
      </nav>
    </aside>

    <!-- ‰∏ªÂå∫Âüü -->
    <main class="main">
      <!-- È°∂ÈÉ®Ê†áÈ¢ò -->
      <header class="topbar">
        <div class="site-title">GOGO delivery</div>
        <div class="top-actions">
          <input class="search" type="text" placeholder="Search for Resturant...." v-on:click="Search()"/>
          <button class="btn">Search</button>
        </div>
      </header>

      <!-- ÂïÜÂÆ∂ÂàóË°® -->
      <section class="merchant-grid" v-if="mode ==='shops'">
        <article v-for="p in provider" :key="p.id" class="merchant card">
          <div class="merchant-head">
            <h3 class="merchant-name">{{ p.name }}</h3>
            <span class="status-pill" :class="p.covid_status">
              Covid: {{ p.covid_status }}
            </span>
          </div>

          <p class="merchant-desc">
            {{ p.description || 'No description' }}
          </p>

          <ul class="items">
            <li v-for="(it, idx) in (p.items || []).slice(0, 3)" :key="idx">
              <span class="item-name" v-if="it.status === 'available'">{{ it.name }}</span>
              <span class="item-name" v-if="it.status === 'out_of_stock'">{{ it.name }} ---- Out of Stock</span>
              <span class="item-price">{{ it.price }}</span>
            </li>
            <li v-if="!p.items || p.items.length === 0">
              <span class="item-name">No Product at this time, sorry</span>
              <span class="item-price">‚Äî</span>
            </li>
          </ul>

          <div class="merchant-actions">
            <button class="btn" :disabled="isBlocked(p.covid_status)">
            {{ isBlocked(p.covid_status) ? 'Cannot Order now' : 'Purchase' }}
            </button>
          </div>
        </article>

      </section>
    </main>
  </div>
</body>
<script src="/javascripts/user_mainpage.js"></script>
</html>